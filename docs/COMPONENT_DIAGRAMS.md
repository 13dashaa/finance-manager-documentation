# Диаграмма Компонентов для "Finance Manager"

Этот документ описывает высокоуровневую архитектуру приложения "Finance Manager" и взаимодействие его ключевых компонентов.

## UC4: Добавление новой транзакции

Диаграмма ниже иллюстрирует процесс обработки запроса на добавление новой финансовой транзакции, так как этот сценарий задействует все основные части системы.

### Участники (Participants):
-   **Веб-браузер (Angular App)**: Клиентское приложение, с которым взаимодействует пользователь. Отвечает за отображение GUI и отправку API-запросов.
-   **API Gateway / Load Balancer**: Единая точка входа для всех запросов к backend. Отвечает за маршрутизацию, безопасность и балансировку нагрузки.
-   **Finance Manager API (Spring Boot)**: Основной серверный компонент (монолит). Содержит всю бизнес-логику: аутентификацию, управление транзакциями, бюджетами, счетами и т.д.
-   **База данных (PostgreSQL)**: Система хранения данных, где персистентно содержатся все сущности (пользователи, счета, транзакции и т.д.).

### Компонентная схема:
![Диаграмма Компонентов UC4: Добавление транзакции](docs/schema/component.jpg)

### Описание потока данных:

1.  **Пользователь** через **Веб-браузер** заполняет форму и отправляет запрос на создание транзакции.
2.  Запрос в виде HTTPS-трафика поступает на **API Gateway**.
3.  **API Gateway** перенаправляет запрос на основной сервис — **Finance Manager API**.
4.  **Finance Manager API** выполняет последовательность действий:
    a. Валидирует JWT (JSON Web Token), чтобы убедиться, что пользователь авторизован.
    b. Обращается к **Базе данных**, чтобы проверить, что счет, на который добавляется транзакция, действительно принадлежит этому пользователю.
    c. Если проверка успешна, создает новую запись в таблице `transactions`.
    d. Обновляет баланс в таблице `accounts`.
    e. При необходимости обновляет доступный остаток в таблице `budgets`.
5.  **База данных** подтверждает успешное выполнение операций.
6.  **Finance Manager API** формирует успешный ответ (`HTTP 201 Created`) или ответ с ошибкой (`HTTP 4xx`) и отправляет его обратно через **API Gateway**.
7.  **Веб-браузер** получает ответ и обновляет пользовательский интерфейс (например, добавляет новую транзакцию в список и изменяет отображаемый баланс).