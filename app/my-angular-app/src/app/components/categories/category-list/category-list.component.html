<!-- src/app/components/categories/category-list/category-list.component.html -->
<h2>Categories</h2>

<!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ -->
<div *ngIf="errorMessage && !isLoading" class="error-message">
  Error: {{ errorMessage }}
</div>

<!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
<div *ngIf="isLoading" class="loading-indicator">Loading categories...</div>

<!-- –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ —Ñ–æ—Ä–º–∞ —Å–∫—Ä—ã—Ç–∞) -->
<div *ngIf="!showAddEditForm && !isLoading" class="controls">
  <button (click)="openAddForm()" class="add-button">
    Add New Category
  </button>
</div>

<!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
<div *ngIf="showAddEditForm" class="add-form-container">
  <h5>{{ isEditMode ? 'Edit Category (ID: ' + currentCategoryId + ')' : 'Add New Category' }}</h5>
  <form (ngSubmit)="onSubmit()" [formGroup]="categoryForm">

    <!-- Category Name -->
    <div class="form-group mb-3">
      <label class="form-label" for="categoryName">Category Name *</label>
      <input
        [class.is-invalid]="categoryForm.get('name')?.invalid && categoryForm.get('name')?.touched"
        class="form-control"
        formControlName="name"
        id="categoryName"
        required
        type="text"
      >
      <div *ngIf="categoryForm.get('name')?.errors?.['required'] && categoryForm.get('name')?.touched"
           class="invalid-feedback">
        Category name is required.
      </div>
      <div *ngIf="categoryForm.get('name')?.errors?.['minlength'] && categoryForm.get('name')?.touched"
           class="invalid-feedback">
        Category name must be at least 2 characters long.
      </div>
      <!-- –î—Ä—É–≥–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏, –µ—Å–ª–∏ –Ω—É–∂–Ω—ã -->
    </div>

    <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ —Ñ–æ—Ä–º—ã (–ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏) -->
    <div *ngIf="errorMessage && categoryForm.touched && !isLoading" class="error-message mb-3">
      {{ errorMessage }}
    </div>

    <!-- –ö–Ω–æ–ø–∫–∏ —Ñ–æ—Ä–º—ã -->
    <div class="form-actions">
      <button [disabled]="categoryForm.invalid || isLoading" class="button-primary" type="submit">
        {{ isLoading ? 'Saving...' : (isEditMode ? 'Update Category' : 'Save Category') }}
      </button>
      <button (click)="cancelForm()" [disabled]="isLoading" class="button-secondary" type="button">
        Cancel
      </button>
    </div>
  </form>
</div>

<!-- –¢–∞–±–ª–∏—Ü–∞ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –Ω–µ –∏–¥–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∞, –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ —Ñ–æ—Ä–º–∞ —Å–∫—Ä—ã—Ç–∞) -->
<div *ngIf="!isLoading && categories.length > 0 && !showAddEditForm" class="table-container">
  <table class="categories-table"> <!-- –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–≤–æ–π –∫–ª–∞—Å—Å –∏–ª–∏ –æ–±—â–∏–π -->
    <thead>
    <tr>
      <th>ID</th>
      <th>Name</th>
      <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    <!-- –ò—Å–ø–æ–ª—å–∑—É–µ–º trackBy –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ -->
    <tr *ngFor="let category of categories; trackBy: trackById">
      <td>{{ category.id }}</td>
      <td>{{ category.name }}</td>
      <td>
        <button (click)="openEditForm(category)" [disabled]="isLoading" class="action-button edit" title="Edit">‚úèÔ∏è
        </button>
        <button (click)="deleteCategory(category.id, category.name)" [disabled]="isLoading" class="action-button delete"
                title="Delete">üóëÔ∏è
        </button>
      </td>
    </tr>
    </tbody>
  </table>
</div>

<!-- –°–æ–æ–±—â–µ–Ω–∏–µ, –µ—Å–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–µ—Ç (–∏ –Ω–µ—Ç –æ—à–∏–±–∫–∏/–∑–∞–≥—Ä—É–∑–∫–∏, —Ñ–æ—Ä–º–∞ —Å–∫—Ä—ã—Ç–∞) -->
<div *ngIf="!isLoading && categories.length === 0 && !errorMessage && !showAddEditForm" class="no-data-message">
  <p>No categories found.</p>
  <p>You can <a (click)="$event.preventDefault(); openAddForm()" href="#">add a new category</a>.</p>
</div>
